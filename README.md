# 情報システム設計 要求仕様書

## 卓球戦績管理システム

### 改版履歴
|日付|版数|変更内容|
|:---:|:---:|:---|
|2021/07/15|初版|初版作成|
|2021/07/24|第2版|ユースケース記述を追加|

### 用語の定義
|用語|定義|
|:---|:---|
|ユーザ|本システムを利用する利用者のこと。|


### 1. 目的
　ユーザが卓球の対戦結果を入力し、自身の卓球の戦績を蓄積することができる。また、蓄積された自身の戦績について、対戦相手を指定して検索することができる。  
 　ユーザがこれらの機能を利用することによって、自身の卓球の戦績を振り返ることが容易になり、日々の卓球の練習に生かすことができるようになることを期待する。  
　なお、本システムは個人での卓球の戦績管理を想定している。


### 2. 機能要件
#### 2-1. 新規登録機能
　ユーザが本システムを利用するために、本システムのデータベースにユーザ情報を登録する機能。  
　ユーザが新規登録ページにおいて必要事項を不足なく正しく入力し、「登録する」ボタンをクリックすることで、新規登録が完了する。入力内容に不足があった場合や正しい情報が入力されなかった場合は、エラーメッセージが表示され、再度入力が求められる。

|入力事項|型|制約|備考|
|:---|:---|:---|:---|
|メールアドレス|VARCHAR(100)|NOT NULL, UNIQUE||
|パスワード|VARCHAR(16)|NOT NULL, 半角英数字のみ, 4文字以上16文字以下|パスワード確認も行う|

#### 2-2. ログイン機能
　ユーザが新規登録時に登録した情報を用いて、本システムの2-3以降の機能を利用するために、ログインする機能。  
　ユーザがログインページにおいて必要事項を不足なく正しく入力し、「ログイン」ボタンをクリックすることで、ログインできる。入力内容に不足があった場合や正しい情報が入力されなかった場合は、エラーメッセージが表示され、再度入力が求められる。

|入力事項|型|制約|備考|
|:---|:---|:---|:---|
|メールアドレス|VARCHAR(100)|NOT NULL, UNIQUE||
|パスワード|VARCHAR(16)|NOT NULL, 半角英数字のみ, 4文字以上16文字以下||

#### 2-3. 対戦結果入力機能
　ユーザが対戦相手との対戦結果を入力し、自身の戦績を本システムのデータベースに蓄積する機能。  
　ユーザは対戦相手との対戦結果として、「対戦の日付」「大会名」「対戦の段階」「対戦相手の名前」「自分の得点」「相手の得点」「コメント」を入力する。  
　対戦結果を不足なく正しく入力し、「送信」ボタンをクリックすることで、対戦結果をデータベースに蓄積することができる。入力内容に不足があった場合や正しい情報が入力されなかった場合は、エラーメッセージが表示され、再度入力が求められる。

|入力事項|型|制約|備考|
|:---|:---|:---|:---|
|対戦の日付|DATE|NOT NULL||
|大会名|VARCHAR(20)|NOT NULL||
|対戦の段階|VARCHAR(10)|NOT NULL|準決勝や第5試合など|
|対戦相手の名前|VARCHAR(20)|NOT NULL|本システムにおいては重複を許可する|
|自分の得点|INT|NOT NULL, UNSIGNED||
|相手の得点|INT|NOT NULL, UNSIGNED||
|コメント|VARCHAR(255)|NULL可|相手の特徴やコンディションなど|

#### 2-4. 対戦結果検索機能
　ユーザが対戦相手を指定することで、2-3.対戦結果入力機能によってデータベースに蓄積された当該の対戦相手との対戦結果を、一覧表示で確認することができる機能。  
　ユーザは対戦結果を表示したい対戦相手の名前を入力して検索する。  
 　対戦相手の名前を入力し、「検索」ボタンをクリックすることで、当該の対戦相手との対戦結果が一覧で表示される。

|入力事項|型|制約|備考|
|:---|:---|:---|:---|
|対戦相手の名前|VARCHAR(20)|NULL可|NULLの場合、全ての対戦結果の一覧が表示される|

#### 2-5. 対戦結果編集機能
　ユーザが2-4.対戦結果検索機能で検索した対戦結果を編集することができる機能。  
　ユーザは検索した対戦結果の中から編集したい対戦結果を指定し、2-3.対戦結果入力機能で入力した事項を書き換え、「上書き」ボタンをクリックすることで、指定した対戦結果を編集することができる。

#### 2-6. 対戦結果削除機能
　ユーザが2-4.対戦結果検索機能で検索した対戦結果を削除することができる機能。  
 　ユーザは検索した対戦結果の中から削除したい対戦結果を指定し、「削除」ボタンをクリックすることで指定した対戦結果をデータベースから削除することができる。
 
#### 2-7. ログアウト機能
　ユーザがシステムを利用後に、他者に不正に利用されないようにログアウトする機能。  
 　ログイン後の各ページ上部にある「ログアウト」ボタンをクリックすることで、ログアウトすることができる。  
 　ログアウト後は、ログインページに遷移する。


### 3. ユースケース記述
#### 3-1. 新規登録機能
|項目|内容|
|:---|:---|
|概要|アクターの情報をシステムに登録する|
|アクター|ユーザ|
|事前条件|なし|
|基本系列|1. システムは新規登録画面を表示する<br> 2. アクターはメールアドレスとパスワードを入力し、新規登録を依頼する<br> 3. システムは入力されたデータに不足がないか及び正しいデータかどうかをチェックする<br> 4. システムは新規登録完了の画面を表示する|
|例外系列|a. 3でデータが不足あるいは正しくない場合<br>　a1. システムはエラーメッセージを表示する<br>　a2. 基本系列1に戻る|
|事後条件|アクターの情報がシステムに登録され、ログインが可能になる|

#### 3-2.  ログイン機能
|項目|内容|
|:---|:---|
|概要|アクターがシステムに登録されているかを確認し、システムの機能を利用可能な状態にする|
|アクター|ユーザ|
|事前条件|アクターの正しいメールアドレスとパスワードがシステムに登録されている|
|基本系列|1. システムはログイン画面を表示する<br> 2. アクターはメールアドレスとパスワードを入力し、ログインを依頼する<br> 3. システムは入力されたデータに不足がないか及び正しいデータかどうかをチェックする<br> 4. システムはログイン後の画面を表示する|
|例外系列|a. 3でデータが不足あるいは正しくない場合<br>　a1. システムはエラーメッセージを表示する<br>　a2. 基本系列1に戻る|
|事後条件|ログインが成功し、システムの機能が利用可能な状態になる|

#### 3-3. 対戦結果入力機能
|項目|内容|
|:---|:---|
|概要|アクターが対戦結果を入力し、入力されたデータをシステムに記録する|
|アクター|ユーザ|
|事前条件|アクターがログインしている|
|基本系列|1. システムは対戦結果入力画面を表示する<br> 2. アクターは対戦結果（詳細は2-3を参照）を入力し、送信する<br> 3. システムは入力されたデータに不足がないか及び正しいデータかどうかをチェックする<br> 4. システムは入力された対戦結果をデータベースに記録する<br> 5. システムは入力内容の確認画面を表示する|
|例外系列|a. 3でデータが不足あるいは正しくない場合<br>　a1. システムはエラーメッセージを表示する<br>　a2. 基本系列1に戻る|
|事後条件|入力された対戦結果がデータベースに記録され、検索可能になる|

#### 3-4. 対戦結果検索機能
|項目|内容|
|:---|:---|
|概要|アクターが対戦相手を指定し、データベースに記録されている対戦結果を表示する|
|アクター|ユーザ|
|事前条件|アクターがログインしている<br>検索したい対戦結果がデータベースに記録されている|
|基本系列|1. システムは対戦結果検索画面を表示する<br> 2. アクターは対戦相手の名前を入力し、送信する<br> 3. システムは入力された内容をデータベースから検索し、表示する<br>　3-1. データベースに記録されている対戦結果の中に存在する対戦相手の名前が入力された場合、入力で指定された対戦相手との対戦結果を一覧で表示する<br>　3-2. 何も入力されなかった場合、データベースに記録された全ての対戦結果の一覧を表示する|
|例外系列|a. 2でデータベースに記録されている対戦結果の中に存在しない対戦相手の名前が入力された場合<br>　a1. システムはエラーメッセージを表示する<br>　a2. 基本系列1に戻る|
|事後条件|指定した対戦相手との対戦結果が表示され、編集及び削除が可能になる|

#### 3-5. 対戦結果編集機能
|項目|内容|
|:---|:---|
|概要|アクターが対戦結果を指定して、対戦結果の内容を編集する|
|アクター|ユーザ|
|事前条件|アクターがログインしている<br>編集したい対戦結果がデータベースに登録されている<br>編集したい対戦結果が検索され、表示されている|
|基本系列|1. アクターは編集したい対戦結果を選択する<br> 2. システムは対戦結果詳細画面を表示する<br> 3. アクターは編集したい対戦結果の項目の内容を編集し、送信する<br> 4. システムはデータベースに記録されている対戦結果の内容を上書きする<br> 5. システムは編集完了画面を表示する|
|例外系列|a. 3で編集した内容に不足があるもしくは正しくない場合<br>　a1. システムはエラーメッセージを表示する<br>　a2. 基本系列2に戻る|
|事後条件|データベースに記録されている指定された対戦結果の内容が上書きされる|

#### 3-6. 対戦結果削除機能
|項目|内容|
|:---|:---|
|概要|アクターが対戦結果を指定して、対戦結果を削除する|
|アクター|ユーザ|
|事前条件|アクターがログインしている<br>削除したい対戦結果がデータベースに登録されている<br>削除したい対戦結果が検索され、表示されている|
|基本系列|1. アクターは削除したい対戦結果を選択する<br> 2. システムは対戦結果詳細画面を表示する<br> 3. アクターは「削除」ボタンを押して、削除の依頼を送信する<br> 4. システムはデータベースに記録されている対戦結果を削除する<br> 5. システムは削除完了画面を表示する|
|例外系列|なし|
|事後条件|データベースに記録されている指定された対戦結果が削除される|

#### 3-7. ログアウト機能
|項目|内容|
|:---|:---|
|概要|アクターがログアウトする|
|アクター|ユーザ|
|事前条件|アクターがログインしている|
|基本系列|1. アクターは「ログアウト」ボタンをクリックする<br> 2. システムはログアウト処理を行う<br> 3. システムはログイン画面を表示する|
|例外系列|なし|
|事後条件|アクターが再度ログインするまで、システムの機能が利用不可能な状態になる|


### 4. データベース設計
#### 4-1. ユーザテーブル（users）

|カラム名|説明|型|制約|備考|
|:---|:---|:---|:---|:---|
|id|ユーザテーブルの主キー|INT|PRIMARY KEY, AUTO INCREMENT||
|email|メールアドレス|VARCHAR(100)|NOT NULL, UNIQUE||
|password|パスワード|VARCHAR(16)|NOT NULL||
|created_at|作成日時|DATETIME|NOT NULL||
|updated_at|更新日時|DATETIME|NOT NULL||

#### 4-2. 対戦結果テーブル（results）

|カラム名|説明|型|制約|備考|
|:---|:---|:---|:---|:---|
|id|対戦結果テーブルの主キー|INT|PRIMARY KEY, AUTO INCREMENT||
|match_date|対戦の日付|DATE|NOT NULL||
|match_name|大会名|VARCHAR(20)|NOT NULL||
|round|対戦の段階|VARCHAR(10)|NOT NULL||
|opponent_name|対戦相手の名前|VARCHAR(20)|NOT NULL||
|my_score|自分の得点|INT|NOT NULL, UNSIGNED||
|opponent_score|相手の得点|INT|NOT NULL, UNSIGNED||
|comment|コメント|VARCHAR(255)|NULL可||
|created_at|作成日時|DATETIME|NOT NULL||
|updated_at|更新日時|DATETIME|NOT NULL||
|user_id|ユーザテーブルのid|INT|NOT NULL|外部キー|